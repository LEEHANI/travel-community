<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="project.board.repository.CommentRepository">
	
	<select id="findByMemberId" resultType="comment">
		SELECT *
		FROM comment
		WHERE member_id = #{memberId}
		LIMIT #{offset}, #{numOfRecords}
	</select>
	
	<select id="getCommentCntByMemberId" parameterType="Long" resultType="Integer">
		SELECT count(*)
		FROM comment
		WHERE member_id = #{memberId};
	</select>
	
	<insert id="insertComment">
		INSERT
		INTO comment(article_id, member_id, parent_comment_id, content, register_date)
		VALUES(#{articleId}, #{memberId}, #{parentCommentId}, #{content}, NOW())
	</insert>
	
	<select id="selectCommentById" resultType="comment">
		SELECT * 
		FROM comment 
		WHERE id = #{id}
	</select>
	
	<select id="selectCommentByArticleId" resultType="commentDto">
		SELECT 
			c.*, 
			m.email writer
		FROM comment c  
		JOIN member m 
		ON c.member_id = m.id 
		WHERE article_id = ${articleId}
	</select>

</mapper>